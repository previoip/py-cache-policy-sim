14a15,19
> # ======= PATCH NOTE =======
> # ========= GLOBAL =========
> # override class config ref into
> # weakref form from parent class
> # ===== PATCH NOTE END =====
42,50c47,55
<         self.lr = config['lr']
<         self.epochs = config['epochs']
<         self.reg_1 = config['reg_1']
<         self.reg_2 = config['reg_2']
< 
<         self.dropout = config['dropout']
<         self.model = config['model_name']
<         self.GMF_model = config['GMF_model']
<         self.MLP_model = config['MLP_model']
---
>         self.lr = self.wref_config['lr']
>         self.epochs = self.wref_config['epochs']
>         self.reg_1 = self.wref_config['reg_1']
>         self.reg_2 = self.wref_config['reg_2']
> 
>         self.dropout = self.wref_config['dropout']
>         self.model = self.wref_config['model_name']
>         self.GMF_model = self.wref_config['GMF_model']
>         self.MLP_model = self.wref_config['MLP_model']
52,53c57,58
<         self.embed_user_GMF = nn.Embedding(config['user_num'], config['factors'])
<         self.embed_item_GMF = nn.Embedding(config['item_num'], config['factors'])
---
>         self.embed_user_GMF = nn.Embedding(self.wref_config['user_num'], self.wref_config['factors'])
>         self.embed_item_GMF = nn.Embedding(self.wref_config['item_num'], self.wref_config['factors'])
55,56c60,61
<         self.embed_user_MLP = nn.Embedding(config['user_num'], config['factors'] * (2 ** (config['num_layers'] - 1)))
<         self.embed_item_MLP = nn.Embedding(config['item_num'], config['factors'] * (2 ** (config['num_layers'] - 1)))
---
>         self.embed_user_MLP = nn.Embedding(self.wref_config['user_num'], self.wref_config['factors'] * (2 ** (self.wref_config['num_layers'] - 1)))
>         self.embed_item_MLP = nn.Embedding(self.wref_config['item_num'], self.wref_config['factors'] * (2 ** (self.wref_config['num_layers'] - 1)))
59,60c64,65
<         for i in range(config['num_layers']):
<             input_size = config['factors'] * (2 ** (config['num_layers'] - i))
---
>         for i in range(self.wref_config['num_layers']):
>             input_size = self.wref_config['factors'] * (2 ** (self.wref_config['num_layers'] - i))
67c72
<             predict_size = config['factors']
---
>             predict_size = self.wref_config['factors']
69c74
<             predict_size = config['factors'] * 2
---
>             predict_size = self.wref_config['factors'] * 2
73,77c78,82
<         self.loss_type = config['loss_type']
<         self.optimizer = config['optimizer'] if config['optimizer'] != 'default' else 'adam'
<         self.initializer = config['init_method'] if config['init_method'] != 'default' else 'xavier_normal'
<         self.early_stop = config['early_stop']
<         self.topk = config['topk']
---
>         self.loss_type = self.wref_config['loss_type']
>         self.optimizer = self.wref_config['optimizer'] if config['optimizer'] != 'default' else 'adam'
>         self.initializer = self.wref_config['init_method'] if config['init_method'] != 'default' else 'xavier_normal'
>         self.early_stop = self.wref_config['early_stop']
>         self.topk = self.wref_config['topk']
